<view class="container" catchtouchmove="preventTouchMove">

<!-- é¡¶éƒ¨çŠ¶æ€ -->
<view class="status-bar">
  <!-- ä¼˜åŒ–ï¼šæ˜¾ç¤ºå…·ä½“çš„ç”»å®¶åå­— -->
  <text class="role">
    {{ isDrawer ? "ğŸ¨ ä½ åœ¨ç”»ç”»" : "ğŸ‘€ " + drawerName + " æ­£åœ¨ç”»" }}
  </text>
  
  <view class="timer {{remainingTime <= 10 ? 'timer-danger' : ''}}">
    â±ï¸ {{remainingTime}}s
  </view>
</view>

<!-- ç­”æ¡ˆï¼ˆç”»çš„äººå¯è§ï¼‰ -->
<view class="answer" wx:if="{{isDrawer}}">
  æœ¬å±€ç­”æ¡ˆï¼š{{answer}}
</view>

<!-- æç¤ºï¼ˆçŒœçš„äººå¯è§ï¼‰ -->
<view class="hint" wx:if="{{!isDrawer && hint}}">
  ğŸ’¡ æç¤ºï¼š{{hint}}
</view>

<!-- ç­‰å¾…é€‰è¯æç¤º -->
<view class="waiting-box" wx:if="{{waitingForChoice}}">
  <text>â³ ç­‰å¾… {{drawerName}} é€‰é¢˜...</text>
</view>

<!-- ç”»æ¿ -->
<canvas canvas-id="board" class="board" bindtouchstart="onTouchStart" bindtouchmove="onTouchMove" bindtouchend="onTouchEnd" style="width:{{boardWidth}}px; height:{{boardHeight}}px"></canvas>

<!-- çŒœè¯åŒºåŸŸ -->
<view wx:if="{{!isDrawer && !showRoundEnd && !waitingForChoice}}" class="guess-box">
  <input placeholder="è¯·è¾“å…¥ä½ çŒœçš„ç­”æ¡ˆ" value="{{guessText}}" bindinput="onGuessInput" />
  <button bindtap="submitGuess">æäº¤</button>
</view>

<!-- æ¸…ç©ºç”»å¸ƒæŒ‰é’® -->
<button wx:if="{{isDrawer && !showChoiceModal}}" class="clear-btn" bindtap="clearBoard">æ¸…ç©ºç”»å¸ƒ</button>

<!-- å†å²çŒœæµ‹ -->
<view wx:if="{{!showRoundEnd && !showChoiceModal && guessHistory.length > 0}}" class="guess-history-container">
  <view class="history-title">ğŸ’¡ çŒœæµ‹è®°å½•</view>
  <scroll-view class="history-scroll" scroll-y="true" scroll-into-view="{{scrollToView}}" scroll-with-animation="true">
    <view class="history-list">
      <block wx:for="{{guessHistory}}" wx:key="index">
        <view class="history-item" id="item-{{index}}">
          <text class="history-name">{{item.player}}:</text>
          <text class="history-text">{{item.text}}</text>
        </view>
      </block>
      <view id="scroll-bottom"></view>
    </view>
  </scroll-view>
</view>

<!-- ç»“æœå¼¹çª— -->
<view wx:if="{{showRoundEnd}}" class="round-end-overlay">
  <view class="round-end-content">
    <text class="title">{{isTimeout ? 'â° æ—¶é—´åˆ°ï¼' : 'ğŸ‰ çŒœå¯¹äº†ï¼'}}</text>
    <view class="drawer-info"><text>ç”»å®¶ï¼š{{lastDrawer}}</text></view>
    <view class="answer-info"><text>ç­”æ¡ˆï¼š{{lastAnswer}}</text></view>
    <image src="{{lastCanvasImage}}" mode="widthFix" class="last-image"></image>
    <button bindtap="closeRoundEnd">å¼€å§‹ä¸‹ä¸€è½®</button>
  </view>
</view>

<!-- é€‰è¯å¼¹çª— -->
<view wx:if="{{showChoiceModal}}" class="choice-modal">
  <view class="choice-content">
    <text class="choice-title">è½®åˆ°ä½ ç”»ç”»äº†ï¼è¯·é€‰æ‹©è¯è¯­ï¼š</text>
    <view class="choice-options">
      <block wx:for="{{choiceOptions}}" wx:key="index">
        <button class="choice-btn" bindtap="chooseWord" data-word="{{item}}">{{item}}</button>
      </block>
    </view>
  </view>
</view>

</view>
